<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Game</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
</head>
<body style="overflow: hidden; cursor: none; background-color: black;">
<script>
'use strict';function g(a,b){b|=0;return((a|0)%b+b)%b}function n(a,b,c){return Math.max(b,Math.min(a,c))}function r(a,b){for(let c of a)if(!c.m)return c;a.push(new b.prototype.constructor);return a[a.length-1]}function aa(a,b,c){return a<b?Math.min(b,a+c):Math.max(b,a-c)}function ba(a,b,c,d,e,f,k){null==b&&(b=new t(0,0));let h=a.x+b.x-c.x/2;a=a.y+b.y-c.y/2;return h+c.x>=d&&h<d+f&&a+c.y>=e&&a<e+k};function v(a,b){let c=a.length();if(1E-4>c)a.x=b?1:0,a.y=0;else return a.x/=c,a.y/=c,a.clone()}function x(a){a.x=0;a.y=0}class t{constructor(a,b){this.x=void 0==a?0:a;this.y=void 0==b?0:b}length(){return Math.hypot(this.x,this.y)}clone(){return new t(this.x,this.y)}}class y{constructor(a,b,c){this.r=n(a,0,255);this.Xa=n(b,0,255);this.Va=n(c,0,255)}clone(){return new y(this.r,this.Xa,this.Va)}};function ca(a,b,c){let d=document.createElement("div");d.setAttribute("style","position: absolute; top: 0; left: 0; z-index: -1;");a.c=document.createElement("canvas");a.c.width=b;a.c.height=c;a.c.setAttribute("style","position: absolute; top: 0; left: 0; z-index: -1;image-rendering: optimizeSpeed;image-rendering: pixelated;image-rendering: -moz-crisp-edges;");d.appendChild(a.c);document.body.appendChild(d);a.U=a.c.getContext("2d");a.U.imageSmoothingEnabled=!1;ea(a)}
function ea(a){var b=window.innerWidth,c=window.innerHeight;a=a.c;var d=Math.min(b/a.width|0,c/a.height|0);let e=a.width*d;d*=a.height;c=String(c/2-d/2|0)+"px";b=String(b/2-e/2|0)+"px";a.style.width=String(e|0)+"px";a.style.height=String(d|0)+"px";a.style.top=c;a.style.left=b}function z(a,b,c,d,e){b=void 0==b?255:b;c=void 0==c?b:c;b="rgba("+String(b|0)+","+String(c|0)+","+String((void 0==d?c:d)|0)+","+String(void 0!=e?e:1);a.U.fillStyle=b;a.U.strokeStyle=b}
function A(a,b,c,d,e,f,k,h,l){var m=e,q=f;if(!(null==b||0>=m||0>=q)){var p=a.U;k+=a.b.x;a=h+a.b.y;c|=0;d|=0;m|=0;q|=0;k|=0;a|=0;e|=0;f|=0;l|=0;0!=l&&p.save();0!=(l&1)&&(p.translate(e,0),p.scale(-1,1),k*=-1);0!=(l&2)&&(p.translate(0,f),p.scale(1,-1),a*=-1);p.drawImage(b,c,d,m,q,k,a,e,f);0!=l&&p.restore()}}function C(a,b,c,d,e,f,k,h){let l=b.width/16|0,m=d;h&&(m=d-=c.length*(l+f)/2);for(let q=0;q<c.length;++q)h=c.charCodeAt(q),10==h?(m=d,e+=l+k):(A(a,b,h%16*l,(h/16|0)*l,l,l,m,e,!1),m+=l+f)}
class fa{constructor(a,b,c){this.U=this.c=null;ca(this,a,b);this.width=a;this.height=b;window.addEventListener("resize",()=>ea(this));this.b=new t(0,0);this.J=null==c?{}:c;this.Ma=0;this.La=new t(0,0)}clear(a,b,c){this.U.fillStyle="rgba("+String(a|0)+","+String(b|0)+","+String(c|0)+",1";this.U.fillRect(0,0,this.width,this.height)}fillRect(a,b,c,d){a+=this.b.x;b+=this.b.y;this.U.fillRect(a|0,b|0,c|0,d|0)}moveTo(a,b){this.b=new t(a,b)}move(a,b){this.b.x+=a;this.b.y+=b}update(a){0<this.Ma&&(this.Ma-=
a.step)}};function ha(a,b){if(null==b)for(b=0;b<a.buttons.length;++b)a.buttons[b]=D;else for(let c=0;c<b.buttons.length;++c){if(c>=a.buttons.length)for(let d=0;d<c-a.buttons.length;++d)a.buttons.push(D);b.buttons[c].pressed?a.buttons[c]==D||a.buttons[c]==E?(a.Da=!0,a.buttons[c]=F):a.buttons[c]=ia:a.buttons[c]=a.buttons[c]==ia||a.buttons[c]==F?E:D}}
function ja(a,b){null!=b&&(a.F.x=0,a.F.y=0,.05<Math.hypot(b.axes[0],b.axes[1])&&(a.F.x=b.axes[0],a.F.y=b.axes[1]),8<=b.axes.length&&.1>Math.hypot(a.F.x,a.F.y)&&.05<Math.hypot(b.axes[6],b.axes[7])&&(a.F.x=b.axes[6],a.F.y=b.axes[7]))}function ka(a,b){return null==b||0>b||b>=a.buttons.length?D:a.buttons[b]}
class la{constructor(){this.F=new t(0,0);this.buttons=[];this.b=null;this.index=0;window.addEventListener("gamepadconnected",a=>{console.log("Gamepad with index "+String(a.gamepad.index)+" connected.");let b=navigator.getGamepads()[a.gamepad.index];this.index=a.gamepad.index;a=this.b=b;ja(this,a);ha(this,a)});this.Da=!1}update(){this.Da=!1;this.F.x=0;this.F.y=0;if(null!=this.b){var a=navigator;a=null==a?null:a.getGamepads?a.getGamepads():a.webkitGetGamepads?a.webkitGetGamepads:null;null!=a&&(this.b=
a[this.index])}a=this.b;ja(this,a);ha(this,a)}};var D=0,E=2,ia=1,F=3;function I(a,b,c,d,e){a.actions[b]={state:D,key:c,ta:d,Qa:e};a.l[c]=!0;return a}
function ma(a){a.b.update();for(let b in a.actions)a.actions[b].state=a.c[a.actions[b].key]|D,a.actions[b].state==D&&(null!=a.actions[b].ta&&(a.actions[b].state=ka(a.b,a.actions[b].ta)),a.actions[b].state==D&&null!=a.actions[b].Qa&&(a.actions[b].state=ka(a.b,a.actions[b].Qa)));a.g=a.F.clone();x(a.F);.1<a.b.F.length()&&(a.F=a.b.F.clone());a.actions.right.state&1?a.F.x=1:a.actions.left.state&1&&(a.F.x=-1);a.actions.down.state&1?a.F.y=1:a.actions.up.state&1&&(a.F.y=-1);a.o=new t(a.F.x-a.g.x,a.F.y-a.g.y)}
function qa(a){return 0>a.F.y&&-.25<=a.g.y&&-.25>a.o.y}function ra(a){return 0<a.F.y&&.25>=a.g.y&&.25<a.o.y}
class sa{constructor(){this.c={};this.l={};this.actions={};this.b=new la;this.F=new t(0,0);this.g=new t(0,0);this.o=new t(0,0);window.addEventListener("keydown",a=>{var b=a.code;this.i=!0;this.c[b]!=ia&&(this.c[b]=F);this.l[b]&&a.preventDefault()});window.addEventListener("keyup",a=>{var b=a.code;this.c[b]!=D&&(this.c[b]=E);this.l[b]&&a.preventDefault()});window.addEventListener("contextmenu",a=>{a.preventDefault()});window.addEventListener("mousemove",()=>{window.focus()});window.addEventListener("mousedown",
()=>{window.focus()});this.i=!1}Ka(){var a=this.c;for(let b in a)a[b]==F?a[b]=ia:a[b]==E&&(a[b]=D);this.i=!1}Da(){return this.i||this.b.Da}};class ta{constructor(){}refresh(){}ab(){}hb(){}};function ua(a,b,c,d){return a.aa[b][g(d,a.height)*a.width+g(c,a.width)]}function va(a,b,c,d,e){c=g(c,a.width);d=g(d,a.height);a.aa[b][d*a.width+c]=e}function wa(a){let b=new xa;for(let c of a.aa)b.aa.push(Array.from(c));b.width=a.width;b.height=a.height;b.b=a.b;return b}class xa{constructor(){this.height=this.width=0;this.aa=[];this.b={}}};class ya{constructor(a,b){this.data=b;this.b=null;this.gain=a.createGain();this.i=this.c=this.g=0;this.loop=!1}play(a,b,c,d){null!=this.b&&(this.b.disconnect(),this.b=null);let e=a.createBufferSource();e.buffer=this.data;e.loop=!!c;b=n(b,0,1);this.gain.gain.value=b;this.g=a.currentTime-d;this.c=0;this.i=b;this.loop=c;e.connect(this.gain).connect(a.destination);e.start(0,d);this.b=e}stop(){null!=this.b&&(this.b.disconnect(),this.b.stop(0),this.b=null)}pause(a){null!=this.b&&(this.c=a.currentTime-this.g,
this.stop())}resume(a){this.play(a,this.i,this.loop,this.c)}};function za(a,b){Aa(a,b,"json",c=>{c=JSON.parse(c);for(let d in c.bitmaps)Ba(a,c.bitmaps[d].name,c.bitmapPath+c.bitmaps[d].path);for(let d in c.tilemaps)Ca(a,c.tilemaps[d].name,c.tilemapPath+c.tilemaps[d].path);for(let d in c.samples)Da(a,c.samples[d].name,c.samplePath+c.samples[d].path)})}
function Aa(a,b,c,d){let e=new XMLHttpRequest;e.overrideMimeType("text/"+c);e.open("GET",b,!0);++a.total;e.onreadystatechange=()=>{4==e.readyState&&("200"==String(e.status)&&void 0!=d&&d(e.responseText),++a.loaded)};e.send(null)}function Ba(a,b,c){++a.total;let d=new Image;d.onload=()=>{++a.loaded;a.J[b]=d};d.src=c}
function Ca(a,b,c){++a.total;Aa(a,c,"xml",d=>{var e=a.bb;{var f=new xa;d=(new DOMParser).parseFromString(d,"text/xml").getElementsByTagName("map")[0];f.width=String(d.getAttribute("width"));f.height=String(d.getAttribute("height"));let l=d.getElementsByTagName("layer");f.aa=[];let m=9999;for(var k of l)k.id<m&&(m=k.id);for(let q=0;q<l.length;++q){k=l[q].id-m;var h=l[q].getElementsByTagName("data")[0].childNodes[0].nodeValue.replace(/(\r\n|\n|\r)/gm,"");h=h.split(",");f.aa[k]=[];for(let p=0;p<h.length;++p)f.aa[k][p]=
parseInt(h[p])}f.b={};d=d.getElementsByTagName("properties")[0];if(void 0!=d)for(let q of d.getElementsByTagName("property"))void 0!=q.getAttribute("name")&&(f.b[q.getAttribute("name")]=q.getAttribute("value"))}e[b]=f;++a.loaded})}function Da(a,b,c){++a.total;let d=new XMLHttpRequest;d.open("GET",c,!0);d.responseType="arraybuffer";d.onload=()=>{a.b.U.decodeAudioData(d.response,e=>{++a.loaded;a.C[b]=new ya(a.b.U,e)})};d.send(null)}function Ea(a){return 0==a.total||a.loaded>=a.total}
class Fa{constructor(a){this.J={};this.bb={};this.C={};this.loaded=this.total=0;this.b=a}load(a){za(this,a)}};function K(a,b,c){a.c&&b.play(a.U,a.ib*c,!1,0)}function Ga(a,b){a.c&&(null!=a.b&&(a.b.stop(),a.b=null),b.play(a.U,.6,!0,0),a.b=b)}function Ha(a){a.c&&null!=a.b&&a.b.pause(a.U)}function Ia(a){a.c&&null!=a.b&&a.b.resume(a.U)}class Ja{constructor(){this.U=new AudioContext;this.b=null;this.ib=1;this.c=!1}toggle(a){this.c=a}};class Ka{constructor(){this.c=0;this.Fa=()=>{};this.b=new y;this.active=!1;this.speed=1;this.g=!1;this.i=this.mode=0;this.v=new t(80,72)}sa(a,b,c,d,e){this.b=new y;this.i=e;this.g=a;this.speed=c;this.c=1;this.Fa=d;this.mode=b;this.active=!0}update(a){this.active&&0>=(this.c-=this.speed*a.step)&&(0==(this.g=!this.g)?(this.c+=1,this.Fa(a)):(this.active=!1,this.c=0))}A(a){if(this.active&&-1!=this.mode){a.moveTo(0,0);var b=this.c;this.g&&(b=1-b);var c=this.v.x,d=this.v.y;switch(this.mode){case 0:null!=
this.i&&(b=Math.round(b*this.i)/this.i);z(a,this.b.r,this.b.Xa,this.b.Va,b);a.fillRect(0,0,a.width,a.height);break;case 1:var e=Math.max(Math.hypot(c,d),Math.hypot(a.width-c,d),Math.hypot(a.width-c,a.height-d),Math.hypot(c,a.height-d));b=(1-b)*e;z(a,this.b.r,this.b.Xa,this.b.Va);{let h=a.U;if(0>=b)h.fillRect(0,0,a.width,a.height);else if(!(b*b>=a.width*a.width+a.height*a.height)){null==c&&(c=a.width/2);null==d&&(d=a.height/2);var f=Math.max(0,d-b)|0;e=Math.min(a.height,d+b)|0;0<f&&h.fillRect(0,0,
a.width,f);e<a.height&&h.fillRect(0,e,a.width,a.height-e);for(let l=f;l<e;++l){var k=l-d;Math.abs(k)>=b?h.fillRect(0,l|0,a.width|0,1):(f=Math.round(c-Math.sqrt(b*b-k*k)),k=Math.round(c+Math.sqrt(b*b-k*k)),0<f&&h.fillRect(0,l|0,f|0,1),k<a.width&&h.fillRect(k|0,l|0,a.width-f|0,1))}}}}z(a)}}};function La(a,b){var c=b.width/4;let d=c/8;b.clear(0,0,0);a=a.u;var e=0==a.total?0:a.loaded/a.total;a=b.width/2-c/2;let f=b.height/2-d/2;a|=0;f|=0;z(b,255,255,255);b.fillRect(a-2,f-2,c+4,d+4);z(b,0);b.fillRect(a-1,f-1,c+2,d+2);c=c*e|0;z(b,255);b.fillRect(a,f,c,d)}
class Ma{constructor(a,b,c){this.c=this.B=0;this.audio=new Ja;this.u=new Fa(this.audio);this.i=new fa(a,b,this.u.J);this.ja=new Ka;this.b={step:c+1,u:this.u,audio:this.audio,ja:this.ja,input:I(I(I(I(new sa,"left","ArrowLeft",14,null),"up","ArrowUp",12,null),"right","ArrowRight",15,null),"down","ArrowDown",13,null),Ra:d=>this.Ra(d)};this.g=new ta(this.b,null);this.o=!1;this.l=this.g}loop(a){const b=16.66667*this.b.step;this.c+=a-this.B;this.c=Math.min(5*b,this.c);this.B=a;a=this.c/b|0;let c=!0,d=Ea(this.u);
d&&!this.o&&(this.g=new this.l.prototype.constructor(this.b,null),this.l=null,this.o=!0);for(;0<a--;)this.i.update(this.b),this.ja.update(this.b),c&&ma(this.b.input),d&&this.g.refresh(this.b),c&&(this.b.input.Ka(),c=!1),this.c-=b;Ea(this.u)?(this.g.ab(this.i),this.ja.A(this.i)):La(this,this.i);window.requestAnimationFrame(e=>this.loop(e))}Ra(a){this.g=new a.prototype.constructor(this.b,this.g.hb())}};function N(a,b,c,d,e,f){b|=0;c|=0;d|=0;e|=0;if(c==d)a.g=0,a.c=c,a.b=b;else{a.b!=b&&(a.g=0,a.c=d>c?c:d,a.b=b);if(c<d&&a.c<c||c>d&&a.c>c)a.c=c;a.g+=f;a.g>e&&(c<d?++a.c>d&&(a.c=c):--a.c<d&&(a.c=c),a.g-=e)}}function O(a,b,c){a.c=b;a.b=c;a.g=0}class P{constructor(a,b){this.width=a;this.height=b;this.g=this.b=this.c=0}A(a,b,c,d,e){A(a,b,this.width*this.c,this.height*this.b,this.width,this.height,c,d,e)}};class Na{constructor(a,b){this.text=a;this.Fa=b}}
class Oa{constructor(a,b,c){this.buttons=[];for(let d of c)this.buttons.push(d);this.width=8*(Math.max(...this.buttons.map(d=>d.text.length))+1);this.height=this.buttons.length*a;this.b=0;this.active=!!b;this.c=a}sa(a){null!=a&&(this.b=a);this.active=!0}update(a){if(this.active){var b=this.b;qa(a.input)?--this.b:ra(a.input)&&++this.b;this.b=g(this.b,this.buttons.length);this.b!=b&&K(a.audio,a.u.C.next,.6);b=this.buttons[this.b];if(a.input.actions.start.state==F||a.input.actions.fire1.state==F)null!=
b.Fa&&b.Fa(a),K(a.audio,a.u.C.accept,.6)}}A(a,b,c){if(this.active){b-=this.width/2;c-=this.height/2;for(let e=0;e<this.buttons.length;++e){var d=this.b==e?"@":" ";d+=this.buttons[e].text;C(a,a.J.font,d,b,c+e*this.c,0,0,!1)}}}};function Q(a,b,c,d,e){return ba(a.a,a.v,a.I,b,c,d,e)}function Pa(a,b){return Q(a,b.a.x-b.I.x/2,b.a.y-b.I.y/2,b.I.x,b.I.y)}function R(a){x(a.speed);x(a.target)}
class Qa{constructor(a,b){this.a=new t(a,b);this.Ba=this.a.clone();this.speed=new t(0,0);this.target=this.speed.clone();this.b=new t(1,1);this.v=new t(0,0);this.I=new t(0,0);this.m=!0;this.H=this.P=!1;this.f=new P(0,0)}Ua(){}xa(){}Ka(){}Oa(){return!0}update(a){this.m&&(this.H?this.P?this.Oa(a)&&(this.P=this.m=!1):(this.Ba=this.a.clone(),this.xa(a),this.speed.x=aa(this.speed.x,this.target.x,this.b.x*a.step),this.speed.y=aa(this.speed.y,this.target.y,this.b.y*a.step),this.a.x+=this.speed.x*a.step,this.a.y+=
this.speed.y*a.step,this.Ka()):this.Ua())}A(){}za(a){this.H=Ra(a,this)}};function Sa(a,b,c,d,e,f){!a.H||!f&&a.ka||!a.m||a.P||0>a.speed.y||(f=a.a.x+a.v.x-a.c.x/2,f+a.c.x<=b+1||f>=b+d-1||(b=a.v.y+a.c.y/2,d=a.Ba.y+b,a.a.y+b>=c-1*e.step&&d<=c+(2+a.speed.y)*e.step&&(a.a.y=c-b,a.la(e),a.speed.y*=-a.qa)))}function Ta(a,b,c,d,e,f){!a.H||!f&&a.ka||!a.m||a.P||0<a.speed.y||(f=a.a.x+a.v.x-a.c.x/2,f+a.c.x<=b+1||f>=b+d-1||(b=a.v.y-a.c.y/2,d=a.Ba.y+b,a.a.y+b<=c+1*e.step&&d>=c-(2-a.speed.y)*e.step&&(a.a.y=c-b,a.wa(e),a.speed.y*=-a.qa)))}
function S(a,b,c,d,e,f,k){!a.H||!k&&a.ka||!a.m||a.P||0>a.speed.x*e||(k=a.a.y+a.v.y-a.c.y/2,k+a.c.y<=c+1||k>=c+d-1||(c=a.v.x+a.c.x/2*e,d=a.Ba.x+c,k=a.a.x+c,!(0<e&&k>=b-1*f.step&&d<=b+(2+a.speed.x)*f.step||0>e&&k<=b+1*f.step&&d>=b-(2-a.speed.x)*f.step)))||(a.a.x=b-c,a.ca(e,f),a.speed.x*=-a.va)}class U extends Qa{constructor(a,b){super(a,b);this.c=this.I.clone();this.ka=!1;this.qa=this.va=0}la(){}ca(){}wa(){}};class Ua extends U{constructor(){super(0,0);this.m=!1;this.f=new P(8,8);this.b=new t(.015,.1);this.qa=this.va=.75;this.c=new t(4,4);this.v=new t(0,7);this.g=!0}ba(a,b,c,d,e){this.a=new t(a,b);this.speed.x=c;this.speed.y=d;this.target.x=0;this.target.y=4;this.m=!0;O(this.f,4*Math.random()|0,e);this.g=!0}Ua(){this.m=!1}A(a){this.m&&this.H&&this.f.A(a,a.J.chips,this.a.x-4,this.a.y+3,0)}la(){!this.g&&.1>this.speed.y&&(this.m=!1);this.g=!1}};const Va=[1,4,8,2,9,6,3,5,12,10,7,13,14,11,15];class Wa{constructor(){this.a=new t(0,0);this.c=this.g=this.speed=this.b=0;this.m=!1}ba(a,b,c,d,e){this.b=0;this.speed=d;this.g=c;this.c=e;this.a=new t(a,b);this.m=!0}update(a,b){this.m&&16<=(this.b+=this.speed*b.step)&&(va(a.Z,this.g,this.a.x,this.a.y+1,this.c+1),this.m=!1)}A(a){this.m&&A(a,a.J.tileset,this.c%16*16,16*(this.c/16|0),16,16,16*this.a.x,16*this.a.y+this.b|0,0)}}
function V(a,b,c,d){if(b.m&&b.H&&!b.P){var e=b.a.x/16|0,f=b.a.y/16|0,k=e-2,h=f-2;e+=4;f+=4;for(let L=0;L<a.Z.aa.length-1;++L)for(let W=h;W<=f;++W)for(let X=k;X<=e;++X){var l=ua(a.Z,L,X,W);if(0!=l){var m=a.B.aa[0][l-1];if(null!=m)if(0<m&&m<=Va.length)Xa(b,m-1,X,W,d);else{var q=a,p=b,w=m-1,T=l-1;l=X;m=W;var J=L,da=c,u=d,M=[2,0,2,8],G=[8,2,0,2],H=[12,8,12,8],B=[8,12,8,12];switch(w){case 15:void 0!=p.Aa&&p.Aa(16*l,16*m,16,16,u);break;case 16:case 17:case 18:case 19:void 0!=p.Za&&p.Za(16*l+M[w-16],16*
m+G[w-16],H[w-16],B[w-16],2,u);break;case 20:case 21:case 22:if(void 0!=p.Wa&&p.Wa(16*l+2,16*m,12,16,u)-1>=w-20){va(q.Z,J,l,m,0);{let na,oa;M=q;G=16*l+8;H=16*m+8;B=w-20;var Y=Math.random()*Math.PI;let mb=2*Math.PI/6;for(let pa=0;6>pa;++pa)oa=Y+mb*pa,na=1.5*Math.random()+1,r(M.b,Ua).ba(G,H,Math.cos(oa)*na,Math.sin(oa)*na*1.75,B);K(u.audio,u.u.C["break"],.5)}20==w&&(ua(q.Z,J,l,m-1)==T+1&&(va(q.Z,J,l,m-1,0),w=l,M=m-1,r(q.c,Wa).ba(w,M,J,1,T)),Ya(da,16*l+8,16*m+8,p.a));break}Xa(p,14,l,m,u);break;case 27:void 0!=
p.Aa&&p.Aa(16*l+8,16*m,16,16,u);break;case 29:void 0!=p.Na&&p.Na(16*l,16*m+8,16,8,u);break;case 30:void 0!=p.Na&&p.Na(16*l,16*m,16,16,u);break;case 31:Sa(p,16*l,16*(m+1),16,u),void 0!=p.Aa&&p.Aa(16*l,16*m+8,16,8,u,4)}}}}}}function Za(a,b){$a(b,a.Z.aa[a.Z.aa.length-1],a.width,a.height)}function Xa(a,b,c,d,e){b=Va[b|0];1==(b&1)&&Sa(a,16*c,16*d,16,e);8==(b&8)&&Ta(a,16*c,16*(d+1),16,e);4==(b&4)&&S(a,16*(c+1),16*d,16,-1,e,!1);2==(b&2)&&S(a,16*c,16*d,16,1,e,!1)}
class ab{constructor(a){this.o=a.bb.base;this.l=a.bb.collisions;this.Z=wa(this.o);this.B=wa(this.l);this.width=this.Z.width;this.height=this.Z.height;this.g=this.i=0;this.b=[];this.c=[]}update(a,b){this.i=(this.i+.5*b.step)%96;this.g=(this.g+.125*b.step)%16;for(let c of this.b)c.za(a),c.update(b),V(this,c,null,b);for(let c of this.c)c.update(this,b)}A(a,b){let c=(10*b.M.x|0)-1;b=(9*b.M.y|0)-1;let d=(a.width/16|0)+2,e=(a.height/16|0)+2;for(let u=0;u<this.Z.aa.length-1;++u){{var f=void 0,k=void 0,h=
void 0,l=a,m=a.J.tileset,q=u,p=c,w=b,T=d,J=e;const M=[133];for(let G=w;G<w+J;++G)for(let H=p;H<p+T;++H)if(h=ua(this.Z,q,H,G),0!=h--)if(M.includes(h)){{let B;k=l;f=m;var da=H;let Y=h%16|0,L=h/16|0;switch(h){case 133:h=16*G+(1+Math.round(Math.sin(this.g/16*Math.PI*2))),B=this.g|0,B%2!=h%2&&++Y,A(k,f,16*Y+B,16*L,16-B,16,16*da,h,0),0<B&&A(k,f,16*Y,16*L,B,16,16*(da+1)-B,h,0)}}}else k=h%16|0,f=h/16|0,A(l,m,16*k,16*f,16,16,16*H,16*G,0)}}for(let u of this.c)u.A(a);for(let u of this.b)u.A(a)}};function bb(a,b){a.P=!0;R(a);K(b.audio,b.u.C.hit2,.5)}
class cb extends U{constructor(){super(0,0);this.m=!1;this.f=new P(16,16);this.c=new t(2,2);this.I=new t(6,6);this.b=new t(.05,.05);this.g=1}ba(a,b,c,d,e,f,k){this.a=new t(a,b);this.speed=new t(c,d);this.target=this.speed.clone();f&&(this.target.y=2);this.g=null==k?1:k;O(this.f,0,e);this.m=!0;this.ka=[2,3].includes(e)}Oa(a){N(this.f,this.f.b,4,8,4,a.step);return 8==this.f.c}xa(a){N(this.f,this.f.b,0,3,4,a.step)}Ua(){this.m=!1}A(a){this.m&&this.H&&this.f.A(a,a.J.bullets,this.a.x-8,this.a.y-8,0)}la(a){bb(this,
a)}wa(a){bb(this,a)}ca(a,b){bb(this,b)}pa(a,b){!this.m||!this.H||this.P||0<a.L||!Pa(a,this)||(a.dir=a.a.x<this.a.x?1:-1,a.Ha(this.g,b),bb(this,b))}};class db{constructor(a,b){this.a=new t(a,b);this.f=new P(16,16);this.H=!0;this.c=0;this.o=!1}za(a){this.H=Ra(a,this)}K(){}l(){}g(){}pa(a,b,c){this.o||!this.H||b.P||(this.g(b),null!=c&&Q(b,this.a.x-8,this.a.y-8,16,16)&&(this.K(b,c),b.G&&(b.Ta=!0,qa(c.input)&&this.l(a))))}};class eb extends db{constructor(a,b,c){super(a,b);this.b=this.B=!1;this.i=0>c;this.c=0;O(this.f,0,this.i?2:0)}update(a){if(this.H&&!this.B){var b=this.i?2:0;this.b?3>this.f.c&&(N(this.f,b+1,0,3,6,a.step),3==this.f.c&&(this.B=!0,this.b=!1)):N(this.f,b,0,3,8,a.step)}}A(a){this.H&&this.f.A(a,a.J.chest,this.a.x-8,this.a.y-8,this.c)}l(){this.b||(this.o=this.b=!0,O(this.f,0,this.i?3:1))}g(a){this.c=a.a.x<this.a.x?0:1}};class fb extends U{constructor(){super(0,0);this.m=!1;this.f=new P(16,16);this.b=new t(.01,.05);this.qa=this.va=.75;this.c=new t(4,8);this.I=new t(8,8);this.v.y=-1;this.id=0;this.g=!1;this.i=!0}ba(a,b,c,d,e){this.a=new t(a,b);this.speed.x=c;this.speed.y=d;this.target.x=0;this.m=!0;this.id=e;O(this.f,0,e);this.g=!1;this.i=!0}xa(a){this.b.x=.01;this.b.y=.05;this.target.y=2;this.g&&(this.i&&(this.speed.x/=2,this.speed.y/=2,this.i=!1),this.b.x/=2,this.b.y/=2,this.target.y/=2);this.g=!1;N(this.f,this.f.b,
0<=this.speed.x?0:3,0<=this.speed.x?3:0,6,a.step)}A(a){this.m&&this.H&&this.f.A(a,a.J.collectibles,this.a.x-8,this.a.y-8,0)}Ea(a,b){this.za(a);this.H?a.jb||(S(this,a.M.x*a.width,a.M.y*a.height,a.height,-1,b),S(this,(a.M.x+1)*a.width,a.M.y*a.height,a.height,1,b)):this.m=!1}pa(a,b,c){if(this.m&&Pa(a,this)){if(0==this.id){var d=a.progress;d.c+=1}else d=a.progress,d.X=Math.min(d.b,d.X+2);this.m=!1;K(c.audio,c.u.C[["coin","heal"][this.id]],.6);c=a.a.x;a=a.a.y+a.v.y-a.f.height/2;d="+"+String.fromCharCode(64+
n(1,0,9))+String.fromCharCode(33+this.id);r(b.Ga,gb).ba(c,a,1,16,30,d)}}Na(a,b,c,d){return Q(this,a,b,c,d)?this.g=!0:!1}};function hb(a,b){a.V=b}function ib(a){a.na();a.L=0;a.X=0;a.P=!0;a.g=0;O(a.f,0,0)}
class Z extends U{constructor(a,b,c,d,e){super(a,b);this.O=this.a.clone();this.f=new P(16,16);O(this.f,0,c+1);this.X=this.lb=d;this.kb=e;this.L=0;this.fb=this.Ca=-1;this.dir=1;this.g=0;this.G=!1;this.b=new t(.1,.1);this.l=1;this.I=new t(8,8);this.c=new t(8,8);this.K=new t(0,0);this.Y=!1;this.V=()=>{};this.$a=this.ra=this.ya=this.fa=this.Ia=!1}R(){}o(){}i(){}B(){}cb(){}na(){}Oa(a){N(this.f,0,0,4,6,a.step);return 4<=this.f.c}sa(){this.ka=this.Y=!1;this.R(this.O.x,this.O.y)}xa(a){this.Y||(this.o(a),
this.i(a),0<this.L&&(this.L-=a.step))}Ka(){this.G=!1}Ha(a,b,c,d,e){this.X-=b;this.Ia||(this.speed.x=this.l*a);this.L=30+this.L%2;0>=this.X&&(this.na(),ib(this),Ya(c,this.a.x,this.a.y+this.v.y,d.a));K(e.audio,e.u.C[this.P?"kill":"hit"],.6);a=this.a.x;d=this.a.y+this.v.y-this.f.height/2;r(c.Ga,gb).ba(a,d,1,16,30,"-"+String(b))}pa(a,b,c){if(this.m&&!this.P&&this.H&&!this.Y&&(this.B(a),0>=this.L&&!this.ya&&a.Za(this.a.x+this.v.x-this.I.x/2,this.a.y+this.v.y-this.I.y/2,this.I.x,this.I.y,this.kb,c)&&this.cb(c),
!this.fa))if(jb(a)&&a.Pa>this.Ca&&ba(this.a,this.v,this.I,a.ea.x-a.ma.x/2,a.ea.y-a.ma.y/2,a.ma.x,a.ma.y)){var d=2;a.W?++d:a.ia&&(d+=2);this.Ha(a.W?0:2*a.dir*(a.ia?1.5:1),d,b,a,c);this.Ca=a.Pa;!this.P&&a.ia&&0<a.T&&(a.speed.x=0,a.target.x=0);a.W&&(a.W=!1,a.$=8,a.ga=!1)}else a.N.m&&a.N.Ya>this.fb&&Pa(this,a.N)&&(this.Ha(2*(this.a.x<a.N.a.x?-1:1),1,b,a.N,c),b=a.N,b.g&&!0,R(b),b.l=0,b.g=!0,this.fb=a.N.Ya)}eb(){}A(a){this.Y||!this.m||!this.H||0<this.L&&0==Math.floor(this.L/2)%2||(this.eb(a),this.f.A(a,
a.J.enemies,Math.round(this.a.x+this.K.x-this.f.width/2),Math.round(this.a.y+this.K.y-this.f.height/2),this.g))}la(){this.G=!0}Ea(a,b){if(this.m){var c=this.H;this.H=Ra(a,this);if(!this.H){if(this.P){this.m=!1;return}if(this.Y){this.sa();return}}!this.P&&this.H!=c&&c&&(this.a=this.O.clone(),R(this),this.X=this.lb,this.L=0,a.jb||(this.ka=this.Y=!0));if(!a.jb&&this.H){c=a.M.x*a.width;var d=a.M.y*a.height;S(this,c,d,a.height,-1,b,!0);S(this,c+a.width,d,a.height,1,b,!0);this.ra&&(Sa(this,c,d+a.height,
a.width,b,!0),Ta(this,c,d,a.width,b,!0))}}}ha(){}};function kb(a){const b=[lb,nb,ob,pb,qb,rb,sb,tb,ub,vb,wb,xb,yb,zb,Ab,Bb,Cb,Db,Eb,Fb,Gb];return b[n(a,0,b.length-1)|0]}
class lb extends Z{constructor(a,b){super(a,b,0,3,2);this.b.x=.025;this.h=!0;this.v.y=2;this.c=new t(4,12);this.K.y=1;this.l=.5}R(a){this.dir=1-(a/16|0)%2*2;this.g=0<this.dir?1:0;this.target.x=.25;this.speed.x=this.target.x;this.target.y=2}o(a){this.target.x=.25*this.dir;this.h&&!this.G&&0>=this.L&&(this.dir*=-1,this.speed.x*=-1,this.target.x*=-1,this.a.x+=this.speed.x*a.step);this.h=this.G}i(a){this.g=0<this.dir?1:0;this.G&&N(this.f,this.f.b,0,3,6,a.step)}ca(){this.speed.x*=-1;this.target.x*=-1;
this.dir*=-1}ha(a){if(0<this.speed.x&&a.a.x>this.a.x||0>this.speed.x&&a.a.x<this.a.x)this.target.x*=-1,this.speed.x*=-1,this.dir*=-1}}
class nb extends Z{constructor(a,b){super(a,b,1,2,1);this.v.y=2;this.c=new t(4,12);this.K.y=1;this.b.y=.05;this.l=.5;this.h=0}R(a){this.target.y=2;this.h=60-(a/16|0)%2*30}o(a){this.G&&0>=(this.h-=a.step)&&(this.h+=60,this.speed.y=-1.75,K(a.audio,a.u.C.jump2,.5))}i(){this.g=0<this.dir?1:0;let a=0;.5<Math.abs(this.speed.y)&&(a=0>this.speed.y?1:2);O(this.f,a,this.f.b)}B(a){this.dir=a.a.x>this.a.x?1:-1}}
class pb extends Z{constructor(a,b){super(a,b,3,2,1);this.b.x=.1;this.j=!0;this.v.y=4;this.c=new t(4,8);this.I=new t(8,6);this.K.y=1;this.l=.5;this.h=!1}R(a){this.dir=1-(a/16|0)%2*2;this.g=0<this.dir?1:0;this.target.y=2}o(a){this.target.x=0;0!=this.f.c%2&&(this.target.x=.6*this.dir);!this.h&&this.j&&!this.G&&0>=this.L&&(this.dir*=-1,this.speed.x*=-1,this.target.x*=-1,this.a.x+=this.speed.x*a.step);this.j=this.G}i(a){this.g=0<this.dir?1:0;this.G?N(this.f,this.f.b,0,3,0==this.f.c%2?30:6,a.step):O(this.f,
2,this.f.b)}ca(a){this.dir=-a}ha(a){if(0<this.speed.x&&a.a.x>this.a.x||0>this.speed.x&&a.a.x<this.a.x)this.dir*=-1,this.speed.x*=-1}B(a){this.h=a.a.y>this.a.y+8&&0>(this.a.x-a.a.x)*this.dir}}
class ob extends Z{constructor(a,b){super(a,b,2,3,2);this.v.y=2;this.c=new t(4,10);this.K.y=0;this.b.x=.05;this.b.y=.1;this.l=.5;this.j=60+(a/16|0)%2*30;this.h=1-(a/16|0)%2*2;this.va=-1}R(){this.target.y=4}o(a){this.G?(this.target.x=0,0>=(this.j-=a.step)&&(this.j+=60,this.speed.y=-2.5,this.target.x=.5*this.h,this.speed.x=this.target.x,this.dir=this.h,K(a.audio,a.u.C.jump2,.5))):this.dir=0<=this.speed.x?1:-1}i(){this.g=0<this.dir?1:0;let a=0;.5<Math.abs(this.speed.y)&&(a=0>this.speed.y?1:2);O(this.f,
a,this.f.b)}B(a){this.h=a.a.x>this.a.x?1:-1;if(jb(a)||a.N.m&&!a.N.g)this.h*=-1}ca(a){this.dir=-a}ha(a){if(0<this.speed.x&&a.a.x>this.a.x||0>this.speed.x&&a.a.x<this.a.x)this.speed.x*=-1,this.dir*=-1}}
class qb extends Z{constructor(a,b){super(a,b,4,3,2);this.b.x=.05;this.v.y=2;this.c=new t(4,12);this.K.y=1;this.l=.75;this.h=60;this.j=!0;this.D=0;this.s=1;this.S=0}R(a){this.dir=1-(a/16|0)%2*2;this.g=0<this.dir?1:0;this.target.y=3;this.h=60;this.j=!0}o(a){let b=this.s;0>=(this.h-=a.step)&&(this.h+=60,this.j&&(this.s+=this.D,this.D=b,20<=++this.S&&(this.S=0,this.s=1,this.D=0),this.dir=1-this.s%2*2,this.h+=(this.a.x|0)%60),this.j=!this.j);this.target.x=this.j?0:.5*this.dir}i(a){this.g=0<this.dir?1:
0;this.G?this.j?O(this.f,0,this.f.b):N(this.f,this.f.b,0,3,8,a.step):O(this.f,4,this.f.b)}ca(){this.j||(this.dir*=-1)}ha(a){if(0<this.speed.x&&a.a.x>this.a.x||0>this.speed.x&&a.a.x<this.a.x)this.dir*=-1,this.speed.x*=-1}}
class rb extends Z{constructor(a,b){super(a,b,5,2,1);this.b.x=.015;this.b.y=.015;this.c=new t(4,4);this.l=.33;this.j=30;this.h=!0;this.s=new t(0,0);this.qa=this.va=1}R(){}o(a){0>=(this.j-=a.step)&&(this.j+=this.h?60:30,this.h?(this.speed.x=.5*this.s.x,this.speed.y=.5*this.s.y):x(this.target),this.h=!this.h);this.h||(this.target=this.speed.clone())}i(a){N(this.f,this.f.b,0,3,this.h?5:3,a.step)}B(a){this.h&&(this.s=v(new t(a.a.x-this.a.x,a.a.y-this.a.y),!0))}ha(a){this.h||(a=v(new t(this.a.x-a.a.x,
this.a.y-a.a.y),!0),this.speed.x=.5*a.x)}}
class sb extends Z{constructor(a,b){super(a,b,6,3,2);this.b.x=.033;this.b.y=.033;this.c=new t(6,6);this.l=.5;this.j=new t(0,0);this.active=!1;this.h=0}R(){this.a.y-=4;this.active=!1;this.h=0}o(a){this.active&&(0<this.h?this.h-=a.step:(this.target.x=.33*this.j.x,this.target.y=.33*this.j.y))}i(a){this.active?0<this.h?O(this.f,1,this.f.b):N(this.f,this.f.b,1,4,6,a.step):O(this.f,0,this.f.b);this.g=0<this.h?2:0}B(a){if(this.active)this.j=v(new t(a.a.x-this.a.x,a.a.y-this.a.y),!0);else if(this.active=
0<this.L||a.a.y>this.a.y&&48>Math.abs(a.a.x-this.a.x))this.h=30,this.target.y=1}}
class Hb extends Z{constructor(a,b,c,d,e,f,k,h){super(a,b,c,d,e);this.b.x=.025;this.c=new t(8,8);this.I=new t(10,8);this.l=.5;this.h=0;this.j=f;this.D=k;this.s=h}R(a){this.dir=1-(a/16|0)%2*2;this.g=0<this.dir?1:0;this.h=(this.a.x+this.a.y)%(2*Math.PI)}o(a){this.target.x=this.s*this.dir;this.h=(this.h+this.D*a.step)%(2*Math.PI);this.a.y=this.O.y+Math.round(Math.sin(this.h)*this.j)}ca(){this.speed.x*=-1;this.target.x*=-1;this.dir*=-1}ha(a){if(0<this.speed.x&&a.a.x>this.a.x||0>this.speed.x&&a.a.x<this.a.x)this.dir*=
-1,this.speed.x*=-1,this.target.x*=-1}}class tb extends Hb{constructor(a,b){super(a,b,7,3,2,2,.1,.125)}i(){this.g=0<this.dir?1:0;let a=1,b=Math.sin(this.h);-.5>b?a=0:.5<b&&(a=2);O(this.f,a,this.f.b)}}function Ib(a,b){a.speed.y=-1;K(b.audio,b.u.C.jump2,.5)}
class ub extends Z{constructor(a,b){super(a,b,8,2,1);this.v.y=2;this.c=new t(4,12);this.K.y=1;this.b.y=.025;this.l=.5;this.h=0}R(a){this.target.y=2;this.h=60-(a/16|0)%2*30}o(a){const b=this.target.y/3;this.G?0>=(this.h-=a.step)&&Ib(this,a):0>=this.h&&this.speed.y>=b&&Ib(this,a)}i(){this.g=0<this.dir?1:0;let a=0;.25<Math.abs(this.speed.y)&&(a=0>this.speed.y?1:2);O(this.f,a,this.f.b)}wa(){this.h=60}}
class Jb extends Z{constructor(a,b,c,d,e){super(a,b,c,d,e);this.v.y=2;this.c=new t(4,12);this.K.y=1;this.l=.5;this.h=!1;this.j=60-(a/16|0)%2*30;this.S=!1}R(){this.target.y=2}s(){}o(a){!this.h&&0>=(this.j-=a.step)&&(O(this.f,1,this.f.b),this.h=!0,this.j=60,this.s(a))}i(a){this.g=0<this.dir?1:0;this.h?(N(this.f,this.f.b,1,3,1==this.f.c?6:30,a.step),3==this.f.c&&(O(this.f,this.S?1:0,this.f.b),this.h=!1)):0!=this.f.c?N(this.f,this.f.b,1,0,6,a.step):O(this.f,0,this.f.b)}B(a){this.dir=a.a.x>this.a.x?1:
-1}}class vb extends Jb{constructor(a,b){super(a,b,9,3,2)}s(a){this.V(this.a.x+4*this.dir,this.a.y,2*this.dir,0,0,!1,1);K(a.audio,a.u.C.snowball,.5)}}class wb extends Hb{constructor(a,b){super(a,b,10,3,2,4,.1,.33);this.b.x=.025;this.l=.5}i(a){this.g=0<this.dir?1:0;N(this.f,this.f.b,0,3,4,a.step)}}function Kb(a,b,c){a.h&&(a.speed.y=b,K(c.audio,c.u.C.jump2,.5))}
class xb extends Z{constructor(a,b){super(a,b,11,6,3);this.b.x=.025;this.v.y=2;this.c=new t(4,12);this.K.y=1;this.l=.33;this.D=this.j=!1;this.s=0;this.h=!1}R(a){this.dir=1-(a/16|0)%2*2;this.g=0<this.dir?1:0;this.target.y=4}o(a){this.target.x=.33*this.dir;!this.G&&this.h&&0<this.speed.x/this.dir&&this.D&&Kb(this,-2.5,a);(this.h=this.G)&&this.j&&Kb(this,-n(this.s/16,1.75,2.75),a)}i(a){this.g=0<this.dir?1:0;let b=5;this.G?N(this.f,this.f.b,0,3,8,a.step):(-.5>this.speed.y?b=4:.5<this.speed.y&&(b=6),O(this.f,
b,this.f.b))}ca(a,b){this.dir==a&&Kb(this,-2.75,b)}B(a){this.D=a.a.y<this.a.y;this.j=48>this.a.y-a.a.y&&24<this.a.y-a.a.y&&a.G;this.dir=a.a.x>this.a.x?1:-1;this.s=Math.abs(a.a.y-this.a.y)}}class yb extends Jb{constructor(a,b){super(a,b,12,3,2);this.S=!0;this.D=0}s(a){this.V(this.a.x+2*this.dir,this.a.y-4,this.D/80,-2,1,!0,1);K(a.audio,a.u.C.snowball,.5)}B(a){this.dir=a.a.x>this.a.x?1:-1;this.D=a.a.x-this.a.x}}
class zb extends Z{constructor(a,b){super(a,b,13,6,3);this.b.y=.1;this.c=new t(16,14);this.K.y=2;this.I=new t(12,12);this.v.y=2;this.l=.5;this.h=this.s=!1;this.j=0;this.Ia=this.D=!0;this.O.y-=2;--this.a.y}R(){--this.a.y;this.h=this.s=!1;this.j=0;this.D=!0}o(a){0<this.j&&0>=(this.j-=a.step)&&(this.h=!0);this.h&&(this.target.y=-.5,this.speed.y=-.5,this.a.y<this.O.y&&(this.a.y=this.O.y,this.h=!1,R(this)))}i(){let a=0;this.s?a=1:0<this.j?a=2:this.h&&(a=3);O(this.f,a,this.f.b)}B(a){0>=this.j&&!this.s&&
!this.h&&a.a.y>this.a.y&&24>Math.abs(a.a.x-this.a.x)&&(this.s=!0,this.target.y=6)}la(a){this.s&&(this.j=60,this.D=this.s=!1,K(a.audio,a.u.C.quake,.4))}wa(){this.h&&(this.a.y=this.O.y,R(this),this.h=!1)}eb(a){this.D||(a.Ma=this.j,a.La=new t(3,3),this.D=!0)}}
class Ab extends Z{constructor(a,b){super(a,b,14,5,3);this.v.y=2;this.c=new t(4,10);this.K.y=0;this.b.x=.025;this.b.y=.1;this.l=.5;this.dir=1-(a/16|0)%2*2;this.qa=this.va=-1}R(a){this.dir=1-(a/16|0)%2*2;this.target.x=.5*this.dir;this.speed.x=this.target.x;this.target.y=4}o(){this.target.x=.5*this.dir}i(a){N(this.f,this.f.b,0,3,6,a.step);this.g=0>this.dir?0:1}ca(a){this.dir=-a;this.speed.x*=-1;this.target.x=this.speed.x}la(a){this.speed.y=-2.25;K(a.audio,a.u.C.jump2,.5)}ha(a){if(0<this.speed.x&&a.a.x>
this.a.x||0>this.speed.x&&a.a.x<this.a.x)this.target.x*=-1,this.speed.x*=-1,this.dir*=-1}}
class Bb extends Z{constructor(a,b){super(a,b,15,3,2);this.b.x=.015;this.b.y=.033;this.c=new t(6,6);this.l=.5;this.j=new t(0,0);this.h=0}R(){this.h=0;this.ka=!0}o(a){this.h=(this.h+.05*a.step)%(2*Math.PI);this.target.x=.33*this.j.x;this.target.y=.33*(this.j.y+1.5*Math.sin(this.h))}i(){let a=1;-.25>this.speed.y?a=0:.25<this.speed.y&&(a=2);O(this.f,a,this.f.b);this.g=0<this.target.x?1:0}B(a){this.j=v(new t(a.a.x-this.a.x,a.a.y-this.a.y),!0)}}
class Cb extends Z{constructor(a,b){super(a,b,16,3,2);this.b.y=.05;this.c=new t(6,6);this.l=.5;this.h=this.D=0;this.ra=!0;this.qa=-1;this.S=this.j=this.s=0;this.da=new t(0,0)}R(a,b){this.j=this.h=0;this.D=0==(b/16|0)%2?1:-1;this.S=this.h=0;this.s=120-(a/16|0)%2*60}o(a){this.a.x=this.O.x+Math.round(4*Math.sin(this.S));0<this.j?this.j-=a.step:(this.S=(this.S+.05*a.step)%(2*Math.PI),this.h=(this.h+.1*a.step)%(2*Math.PI),this.target.y=this.D*(Math.sin(this.h)+.2)*.5,0>=(this.s-=a.step)&&(this.V(this.a.x+
4*(0==this.g?-1:1),this.a.y+2,1*this.da.x,1*this.da.y,2,!1,2),K(a.audio,a.u.C.snowball,.5),this.j=30,R(this),this.s+=120))}i(){if(0<this.j)O(this.f,3,this.f.b);else{var a=1;-.25>this.speed.y?a=0:.25<this.speed.y&&(a=2);O(this.f,a,this.f.b);this.g=0<this.target.x?1:0}}la(){this.D=-1;this.target.y*=-1;this.h=0}wa(){this.D=1;this.target.y*=-1;this.h=0}B(a){this.g=a.a.x<this.a.x?0:1;this.da=v(new t(a.a.x-this.a.x,a.a.y-this.a.y),!0)}}
class Db extends Z{constructor(a,b){super(a,b,17,1,3);this.b.x=.025;this.v.y=2;this.c=new t(4,12);this.K.y=1;this.l=.33}R(a){this.dir=1-(a/16|0)%2*2;this.g=0<this.dir?1:0;this.target.y=4}o(){this.target.x=this.dir}i(a){this.g=0<this.dir?1:0;this.G?N(this.f,this.f.b,0,3,6,a.step):O(this.f,4,this.f.b)}B(a){this.dir=a.a.x>this.a.x?1:-1}cb(a){K(a.audio,a.u.C.kill,.6);ib(this)}na(){let a;for(let b=0;4>b;++b)a=Math.PI/4+b*Math.PI/2,this.V(this.a.x,this.a.y+this.v.y,2*Math.cos(a),2*Math.sin(a),3,!1,2)}}
class Eb extends Z{constructor(a,b){super(a,b,18,1,1);this.b.y=.1;this.c=new t(8,10);this.K.y=2;this.v.y=2;this.l=.5;this.fa=this.Ia=!0;this.O.y-=4;this.a.y-=4;this.j=this.h=0;this.$a=!0}R(a){this.h=0;this.j=60-(a/16|0)%2*60/2;O(this.f,8,this.f.b)}o(a){this.ya=this.fa=2!=this.h;this.target.y=0;0==this.h?0>=(this.j-=a.step)&&(this.h=1,O(this.f,0,this.f.b)):2==this.h&&(this.target.y=2)}i(a){0==this.h?O(this.f,8,this.f.b):1==this.h?(N(this.f,this.f.b,0,4,10,a.step),4==this.f.c&&(this.h=2)):3==this.h&&
(N(this.f,this.f.b,5,8,6,a.step),8==this.f.c&&(this.h=0,this.a=this.O.clone(),this.j=60))}la(a){2==this.h&&(this.h=3,R(this),K(a.audio,a.u.C.blob,.7))}}
class Fb extends Z{constructor(a,b){super(a,b,19,6,3);this.b.x=.05;this.D=!0;this.v.y=2;this.c=new t(8,12);this.K.y=1;this.l=.75;this.s=!1;this.j=0;this.h=!1}R(a){this.h=!1;this.j=60-(a/16|0)%2*60/2;this.dir=1-(a/16|0)%2*2;this.g=0<this.dir?1:0;this.target.y=4}o(a){this.target.x=.5*this.dir;!this.s&&this.D&&!this.G&&0>=this.L&&(this.dir*=-1,this.speed.x*=-1,this.target.x*=-1,this.a.x+=this.speed.x*a.step);this.D=this.G;0>=(this.j-=a.step)&&(this.h=!this.h,this.j+=this.h?30:60,this.h&&(this.V(this.a.x+
8*this.dir,this.a.y+2,2*this.dir,0,4,!1,2),K(a.audio,a.u.C.snowball,.5)))}i(a){this.g=0<this.dir?1:0;let b=this.h?5:0;this.G?N(this.f,this.f.b,b,b+3,8,a.step):O(this.f,b+4,this.f.b)}ca(a){this.dir=-a}ha(a){if(0<this.speed.x&&a.a.x>this.a.x||0>this.speed.x&&a.a.x<this.a.x)this.dir*=-1,this.speed.x*=-1}B(a){this.s=a.a.y>this.a.y+8&&0>(this.a.x-a.a.x)*this.dir}}
class Gb extends Z{constructor(a,b){super(a,b,20,6,3);this.b.x=.025;this.b.y=.025;this.c=new t(6,6);this.l=.66;this.s=0;this.D=new t(0,0);this.S=new t(0,0);this.da=this.h=this.j=0;this.ra=!0}R(a){this.s=this.a.y%(2*Math.PI);this.ka=!0;this.j=120-(a/16|0)%2*120/2}o(a){0<this.h?this.h-=a.step:(this.target.x=.75*this.D.x,this.target.y=.75*this.D.y,this.s=(this.s+.025*a.step)%(2*Math.PI),0>=(this.j-=a.step)&&(this.V(this.a.x,this.a.y,1.5*this.S.x,1.5*this.S.y,3,!1,2),K(a.audio,a.u.C.snowball,.5),this.h=
30,this.da=this.f.c,O(this.f,this.f.c+5,this.f.b),R(this),this.j+=120))}i(a){0<this.h?O(this.f,this.da+Math.floor(this.h/8)%2*5,this.f.b):(N(this.f,this.f.b,0,4,5,a.step),this.g=0<this.target.x?1:0)}B(a){this.D=v(new t(a.a.x+32*Math.cos(this.s)-this.a.x,a.a.y+32*Math.sin(this.s)-this.a.y),!0);this.S=v(new t(a.a.x-this.a.x,a.a.y-this.a.y),!0)}};class gb{constructor(){this.a=new t(0,0);this.speed=0;this.text="";this.c=this.b=0;this.m=!1}ba(a,b,c,d,e,f){this.a=new t(a,b);this.speed=c;this.b=d;this.c=e;this.text=f;this.m=!0}update(a){this.m&&(0<this.b?(this.b-=a.step,this.a.y-=this.speed):0>=(this.c-=a.step)&&(this.m=!1))}A(a){this.m&&C(a,a.J.spcfont,this.text,this.a.x|0,this.a.y-5|0,-3,0,!0)}};class Lb extends U{constructor(){super(0,0);this.f=new P(16,16);this.g=!1;this.l=0;this.o=null;this.B=0;this.b=new t(.1,.1);this.c=new t(4,4);this.I=new t(10,10);this.i=this.H=this.m=!1;this.Ya=0}ba(a,b,c,d,e,f){this.a=new t(a,b);this.speed=new t(c,d);this.target=this.speed.clone();this.g=!1;this.l=e;this.o=f;this.B=this.speed.length();this.H=this.m=!0;this.i=this.ka=this.P=!1;++this.Ya}xa(a){let b=new t(this.a.x-this.o.a.x,this.a.y-this.o.a.y),c=b.length();v(b,!1);this.g?(this.target.x=-b.x*this.B,
this.target.y=-b.y*this.B,this.i||(this.i=Math.sign(this.target.x)==Math.sign(this.speed.x)&&Math.sign(this.target.y)==Math.sign(this.speed.y)),12>c&&(this.m=!1)):0>=(this.l-=a.step)&&(this.g=!0);N(this.f,5,1,4,4,a.step);this.ka=this.g&&this.i}A(a){this.m&&this.f.A(a,a.J.figure,this.a.x-8|0,this.a.y-8|0,0<=this.speed.x?0:1)}ca(){this.i=!0;this.g||(this.l=0,this.g=!0)}Wa(a,b,c,d){return this.m&&Q(this,a,b,c,d)?1:0}};function jb(a){return a.W&&0<=a.speed.y||a.S&&a.T>(a.ia?0:15)}function Mb(a,b){a.o&&(a.dir*=-1,a.g=0==a.g?1:0);a.O=!1;a.T=20;R(a);b?a.i||(a.speed.x=1.25*a.dir,a.target.x=a.speed.x):a.T+=10;a.ia=b;a.$=0;a.l=0;a.S=!0;var c=a.a.y+2;a.ea.x=a.a.x+13*a.dir;a.ea.y=c;a.ma.x=12;a.ma.y=b?10:4;++a.Pa}
class Nb extends U{constructor(a,b,c){super(a,b);this.Sa=new t(a,b);this.gb=null;this.f=new P(16,16);O(this.f,4,4);this.fa=new P(16,16);this.g=0;this.b=new t(.1,.15);this.v=new t(0,2);this.I=new t(8,12);this.c=new t(6,12);this.G=!1;this.$=0;this.ga=!1;this.h=0;this.K=this.s=this.i=!1;this.T=this.l=0;this.Y=this.O=this.S=!1;this.da=0;this.ia=!1;this.ea=new t(0,0);this.ma=new t(0,0);this.Pa=0;this.W=!1;this.V=0;this.o=!1;this.Ca=this.B=0;this.N=new Lb;this.N.m=!1;this.dir=1;this.j=this.L=0;this.progress=
c;this.ya=this.na=!1;this.H=!0;this.ra=0;this.Ta=!1;this.D=0}xa(a){this.s&&!this.i&&(this.s=!1);this.dir=0==this.g?1:-1;var b=a.input.actions.fire2.state;if(b=b==E||b==D)this.Y&&b?(this.Y=!1,this.da=0,Mb(this,!0),K(a.audio,a.u.C.powerAttack,.6)):!this.ia&&0<this.T&&10>=this.T&&(this.T=0);if(!(0<this.T||this.W||(this.target.y=2,0<this.j))){this.target.x=1*a.input.F.x;this.o&&!this.K&&(this.target.y*=.25);this.b=new t(.1,.15);a:{if(a.input.actions.fire2.state==F){if(!this.i&&!this.K&&!this.G&&.1<a.input.F.y){R(this);
this.speed.y=-3;this.target.y=4;this.b.y=.35;this.W=!0;this.V=0;b=this.a.y+16;this.ea.x=this.a.x;this.ea.y=b;this.ma.x=8;this.ma.y=12;++this.Pa;K(a.audio,a.u.C.downAttack,.6);b=!0;break a}if(this.O){Mb(this,!1);K(a.audio,a.u.C.sword,.5);b=!0;break a}}b=!1}if(b=!b)this.N.m?b=!1:(this.o&&(this.dir*=-1,this.g=0==this.g?1:0),a.input.actions.fire3.state==F?(this.N.ba(this.a.x+4*this.dir,this.a.y+2,2*this.dir,0,24,this),this.N.Ba.x=this.a.x,R(this),this.T=30,this.S=!1,this.l=this.$=0,K(a.audio,a.u.C["throw"],
.6),b=!0):b=!1),b=!b;if(b&&(this.K&&(this.b.x*=.5,this.b.y*=.25,this.target.x*=.5,this.target.y*=.25,this.o=!1,this.B=0),b=a.input.actions.fire1.state,this.i?(.1<a.input.F.x?this.g=0:-.1>a.input.F.x&&(this.g=1),this.target.y=.5*a.input.F.y,this.target.x=0,b==F&&(.1>a.input.F.y&&(this.$=14),this.s=this.i=this.ga=!1,K(a.audio,a.u.C.jump,.5)),b=!0):b=!1,!b)){b=a.input.actions.fire1.state;if(b==F)if(!this.K&&this.G&&.1<a.input.F.y)this.l=20,K(a.audio,a.u.C.jump,.5);else{if(this.G||0<this.h||!this.ga||
0<this.B)this.$=(this.ga=!this.G&&0>=this.h&&0>=this.B)?8:14,this.G=!1,this.h=0,0<this.B&&(this.speed.x=-2*this.Ca),this.o=!1,this.B=0,this.O=!0,this.ya=!1,K(a.audio,a.u.C.jump,.5)}else b==E&&(0<this.$?this.$=0:0<this.l&&(this.l=0),this.ya=!0);if(this.na=this.ya&&this.ga&&0>=this.T&&this.ga&&1==(b&1)&&0>=this.$)this.target.y=.5,this.speed.y=this.target.y}}0<this.T&&this.ia?this.ea.x+=this.speed.x*a.step:this.W&&(this.ea.y+=this.speed.y*a.step);b=1/30;this.Ta&&(this.D+=b*a.step,this.D%=1);0<this.$&&
(this.speed.y=-2,this.K&&(this.speed.y*=.5),this.$-=a.step);0<this.l&&(this.speed.x=2*this.dir,this.target.x=this.speed.x,this.l-=a.step);0<this.h&&(this.h-=a.step);0<this.B&&(this.B-=a.step);0<this.T&&(this.T-=a.step,!this.ia&&this.S&&0>=this.T&&(this.Y=!0,K(a.audio,a.u.C.charge,.5)));0<this.V&&0>=(this.V-=a.step)&&(this.W=!1);this.Y&&(this.da=(this.da+a.step)%20);0<this.L&&(0<this.j?(this.j-=a.step,0>=this.progress.X&&0>=this.j&&(this.P=!0,O(this.f,0,7),R(this),b=a.audio,b.c&&null!=b.b&&(b.b.stop(b.U),
b.b=null),K(a.audio,a.u.C.die,.5))):this.L-=a.step);{b=this.f.c;let c=this.f.b;if(0<this.j)O(this.f,0,5);else if(this.W)O(this.fa,3,4),O(this.f,1,4);else if(0<this.T)O(this.f,0,4),this.ia?N(this.fa,4,7,8,4,a.step):O(this.fa,2,4);else if(0<this.l)O(this.f,4,1);else if(.1<Math.abs(this.target.x)&&(this.g=0>this.target.x?1:0),this.o)O(this.f,3,1);else if(this.K)0<=this.speed.y&&.1<Math.abs(this.target.x)?N(this.f,3,0,1,10,a.step):(b=0>this.speed.y?2:0,O(this.f,b,3));else if(this.i){if(3!=this.f.b||.1<
Math.abs(this.target.y))N(this.f,3,3,4,10,a.step),(this.f.b!=c||this.f.c!=b&&3==this.f.c)&&K(a.audio,a.u.C.climb,.6)}else this.na?(N(this.f,6,0,3,3,a.step),(this.f.b!=c||this.f.c!=b&&0==this.f.c)&&K(a.audio,a.u.C.flap,.5)):this.G?.1>Math.abs(this.speed.x)&&.1>Math.abs(this.target.x)?O(this.f,0,0):(b=12-6*Math.abs(this.speed.x),N(this.f,0,1,4,b,a.step)):this.ga&&0>this.speed.y?N(this.f,2,0,4,4,a.step):(b=0,.5>Math.abs(this.speed.y)?b=1:0<this.speed.y&&(b=2),O(this.f,b,1))}this.N.update(a);this.K=this.i=
!1}Ka(){this.Ta=this.o=this.G=!1}Oa(a){N(this.f,7,0,3,3,a.step);return 120<=(this.ra+=a.step)}A(a){if(this.P){var b=1*this.ra;for(var c=0;8>c;++c){var d=2*Math.PI/8*c;var e=this.a.x+this.v.x+Math.cos(d)*b;d=this.a.y+this.v.y+Math.sin(d)*b;this.f.A(a,a.J.figure,e-8,d-8,0)}this.N.A(a)}else 0<this.L&&0!=Math.floor(this.L/2)%2||(c=this.f.c,this.Y&&0==Math.floor(this.da/2)%2&&(c+=5),b=Math.round(this.a.x-8),e=Math.round(this.a.y-7),0<this.T&&this.S&&this.fa.A(a,a.J.figure,b+12-24*this.g,e+1,this.g),d=
this.f,A(a,a.J.figure,d.width*c,d.height*this.f.b,d.width,d.height,b,e,this.g),this.W&&this.fa.A(a,a.J.figure,b+3-6*this.g,e+7,this.g),this.N.A(a),this.Ta&&(c=this.f,A(a,a.J.figure,c.width*(3+Math.floor(this.D/.5)),7*c.height,c.width,c.height,b,e-16,0)))}la(){this.G=!0;this.ga=!1;this.h=12;.1<this.speed.y&&(this.s=this.i=!1);this.O=!0;this.W&&0>=this.V&&(this.V=20);this.B=0;this.o=!1}ca(a,b){!this.i&&!this.W&&0>=this.T&&!this.K&&0<this.speed.y&&.1<b.input.F.x*a&&(this.o=!0,this.B=15,this.Ca=a,this.O=
!0)}wa(){this.$=0}Aa(a,b,c,d,e,f){return Q(this,a+4,b,c-8,d)?this.s?(this.O=!0,void 0==f&&(this.i=!0),!0):qa(e.input)||ra(e.input)?(this.s=this.i=this.O=!0,this.a.x=a+8,void 0!=f&&(this.a.y=b+f),R(this),!0):!1:!1}Na(a,b,c,d){return Q(this,a,b,c,d)?(this.K=!0,this.h=1,this.ga=!1,this.l=0,this.O=!0):!1}Ea(a,b){let c=a.a.x*a.width,d=a.a.y*a.height,e=a.target.x-a.a.x,f=a.target.y-a.a.y,k=(this.I.x+2)*a.Ja,h=(this.I.y+2)*a.Ja,l=0,m=0,q;a.oa?(this.a.x+=e*k*b.step,this.a.y+=f*h*b.step):0>=this.j?(0<this.speed.x&&
this.a.x+this.v.x+this.I.x/2>c+a.width?l=1:0>this.speed.x&&this.a.x+this.v.x-this.I.x/2<c?l=-1:0<this.speed.y&&this.a.y+this.v.y+this.I.y/2>d+a.height?m=1:0>this.speed.y&&this.a.y+this.v.y-this.I.y/2<d&&(m=-1),0==l&&0==m||0==(q=a.move(l,m,.05))||(this.a.x+=q*a.width*a.ua)):(S(this,a.M.x*a.width,a.M.y*a.height,a.height,-1,b),S(this,(a.M.x+1)*a.width,a.M.y*a.height,a.height,1,b));null!=this.N&&this.N.m&&!Ra(a,this.N)&&(this.N.m=!1)}Ha(a,b){this.g=0<this.dir?0:1;this.L=60;this.j=30;this.target.x=0;this.speed.x=
2*-this.dir;this.i=!1;this.T=0;this.na=this.Y=this.o=this.W=!1;var c=this.progress;c.X=Math.max(0,c.X-a);K(b.audio,b.u.C.hurt,.5)}Za(a,b,c,d,e,f){if(!(0<this.L))return Q(this,a,b,c,d)?(this.dir=this.a.x<a+c/2?1:-1,this.Ha(e,f),!0):!1}Wa(a,b,c,d){return(jb(this)||0<this.V)&&ba(this.ea,null,this.ma,a,b,c,d)?this.ia||this.W?2:1:0}};class Ob extends db{constructor(a,b){super(a,b);this.active=!1}update(a){this.H&&(this.active?N(this.f,0,1,8,6,a.step):O(this.f,0,0))}A(a){this.H&&this.f.A(a,a.J.savepoint,this.a.x-8,this.a.y-8,0)}K(a,b){this.active||(this.active=!0,a.Sa=this.a.clone(),a.gb=this,null!=b&&K(b.audio,b.u.C.savepoint,.6))}l(a){console.log("Not implemented yet.");Pb(a).sa(()=>{})}g(a){this.active=a.gb==this}};function $a(a,b,c,d){let e=0,f=0;for(let k=0;k<d;++k)for(let h=0;h<c;++h)if(f=b[k*c+h]-512,!(0>=f)){--f;switch(f){case 0:a.b=new Nb(16*h+8,16*k+8,a.progress);break;case 32:a.g.push(new Ob(16*h+8,16*k+8));break;case 33:a.g.push(new eb(16*h+8,16*k+8,-1))}if(1<=f&&31>=f){e=a.c.length;for(let l=0;l<a.c.length;++l)if(!a.c[l].m){e=l;break}a.c[e]=new (kb(f-1).prototype.constructor)(16*h+8,16*k+8);a.c[e].R(16*h+8,16*k+8);hb(a.c[e],(l,m,q,p,w,T,J)=>{r(a.i,cb).ba(l,m,q,p,w,T,J)})}}}
function Ya(a,b,c,d){let e=(b-d.x)/16*.75;e=n(e,-.75,.75);d=Math.max(0,c-d.y)/16*2;d=n(d,-2,2);var f=a.b.progress;f=Math.random()<.25*(1-f.X/f.b)?1:0;r(a.l,fb).ba(b,c,e,-1.5+d,f)}function Qb(a,b){b.v=new t((a.b.a.x|0)%160,(a.b.a.y|0)%144)}function Rb(a,b){for(let c of a.c)c.za(b);for(let c of a.g)c.pa(null,a.b,null)}
class Sb{constructor(a){this.b=null;this.c=[];this.Ga=[];this.l=[];this.i=[];this.g=[];this.progress=a}update(a,b,c,d){for(let h of this.c)if(h.Ea(a,d),a.oa||(h.update(d),h.pa(this.b,this,d),V(b,h,this,d)),h.m&&!h.P&&h.H)for(let l of this.c)if(l!=h)a:{var e=void 0,f=h,k=l;if(!k.m||k.P||!k.H||!f.m||f.P||!f.H||k.$a||f.$a)break a;e=Math.hypot(f.I.x/2,f.I.y/2);let m=Math.hypot(k.I.x/2,k.I.y/2),q=new t(f.a.x+f.v.x-k.a.x-k.v.x,f.a.y+f.v.y-k.a.y-k.v.y),p=q.length();v(q);p<e+m&&(e=e+m-p,f.Ia||(f.a.x+=q.x*
e/2,f.a.y+=q.y*e/2),f.ha(k),k.Ia||(k.a.x-=q.x*e/2,k.a.y-=q.y*e/2),k.ha(f))}a.oa||(this.b.update(d),V(b,this.b,this,d),this.b.N.m&&V(b,this.b.N,this,d));this.b.Ea(a,d);for(let h of this.Ga)h.update(d);for(let h of this.g)h.za(a),h.update(d),h.pa(c,this.b,d);for(let h of this.i)h.za(a),h.update(d),V(b,h,this,d),h.pa(this.b,d);for(let h of this.l)h.Ea(a,d),h.update(d),h.pa(this.b,this,d),V(b,h,this,d);return this.b.m}A(a){for(let b of this.g)b.A(a);for(let b of this.c)b.A(a);for(let b of this.l)b.A(a);
this.b.A(a);for(let b of this.i)b.A(a);for(let b of this.Ga)b.A(a)}};class Tb{constructor(){this.X=this.b=10;this.c=0}};function Ra(a,b){if(void 0==b.f)return!1;let c=a.M.x*a.width,d=a.M.y*a.height;return b.a.x+b.f.width/2>=c&&b.a.y+b.f.height/2>=d&&b.a.x-b.f.width/2<c+a.width&&b.a.y-b.f.height/2<d+a.height}
class Ub{constructor(a,b,c,d,e,f,k){this.a=new t(a,b);this.target=this.a.clone();this.M=this.a.clone();this.g=this.a.clone();this.width=c;this.height=d;this.oa=!1;this.Ja=this.b=0;this.ua=e;this.i=f;this.c=k}move(a,b,c){if(this.oa||!this.c&&(0==this.a.x&&0>a||this.a.x==this.ua-1&&0<a)||!this.l&&(0==this.a.y&&0>b||this.a.y==this.i-1&&0<b))return 0;this.b=1;this.Ja=c;this.target.x=this.a.x+a|0;this.target.y=this.a.y+b|0;this.oa=!0;return this.c&&0>this.target.x?(this.a.x+=this.ua,this.target.x+=this.ua,
1):this.c&&this.target.x>=this.ua?(this.a.x-=this.ua,this.target.x-=this.ua,-1):0}update(a){this.oa&&(0>=(this.b-=this.Ja*a.step)?(this.b=0,this.a=this.target.clone(),this.M=this.a.clone(),this.oa=!1):(a=this.b,this.M.x=a*this.a.x+(1-a)*this.target.x,this.M.y=a*this.a.y+(1-a)*this.target.y))}setPosition(a,b){this.a=new t(a,b);this.target=this.a.clone();this.M=this.a.clone()}};function Pb(a){a.c.push("Haha lol.\nNot implemented\nyet.");a.i.push(Vb());return a}function Vb(){let a=new t(0,0),b=["Haha lol.","Not implemented","yet."].map(c=>c.length);a.x=8*Math.max(...b);a.y=10*b.length;return a}
class Wb{constructor(){this.c=[];this.i=[];this.b=this.g=this.char=0;this.active=!1;this.l=0}sa(){this.active=!0;this.b=this.g=0}update(a){if(this.active){var b=a.input.Da();this.b<this.c[0].length?b?this.b=this.c[0].length:2<=(this.g+=1*a.step)&&(this.g-=2,++this.b,a=this.c[0].charCodeAt(this.b),this.b<this.c[0].length&&"\n"==a&&++this.b):(b&&(this.c.shift(),this.i.shift(),this.g=this.b=0,K(a.audio,a.u.C.next,.6),0==this.c.length&&(this.active=!1)),this.l=(this.l+.1*a.step)%(2*Math.PI))}}A(a,b){if(this.active){var c=
this.i[0].x+4,d=this.i[0].y+4,e=a.width/2-c/2,f=a.height/2-d/2;if(b){{b=[[0,0,0],[255,255,255][0,0,0],[0,85,170]];let k=b.length-1;for(let h=0;h<b.length;++h,--k)z(a,b[h][0],b[h][1],b[h][2],1),a.fillRect(e-k,f-k,c+2*k,d+2*k)}}C(a,a.J.font,this.c[0].substr(0,this.b),e+2,f+2,0,2,!1);this.b==this.c[0].length&&(b=Math.round(Math.sin(this.l))|0,A(a,a.J.font,24,0,8,8,e+c-8,f+d-2+b,!1))}}};class Xb extends ta{constructor(a,b){super(a,b);this.g=new ab(a.u);this.b=new Ub(0,0,160,144,this.g.width/10|0,this.g.height/9|0,!0);this.progress=new Tb;this.message=new Wb;this.c=new Sb(this.progress);Za(this.g,this.c);b=this.c;this.b.setPosition(b.b.a.x/160|0,b.b.a.y/144|0);this.i=!1;Ga(a.audio,a.u.C.testTrack);a.ja.sa(!1,1,1/30,null,new y(0,0,0));Qb(this.c,a.ja);Rb(this.c,this.b)}refresh(a){a.ja.active||(this.message.active?this.message.update(a):(a.input.actions.start.state==F&&((this.i=!this.i)?
Ha(a.audio):Ia(a.audio),K(a.audio,a.u.C.pause,.6)),this.i||(this.g.update(this.b,a),this.c.update(this.b,this.g,this.message,a)?this.b.update(a):(a.ja.sa(!0,1,1/30,b=>{var c=this.g;c.Z=wa(c.o);c.B=wa(c.l);for(var d of c.b)d.m=!1;for(var e of c.c)e.m=!1;d=this.c;e=this.g;c=d.b.Sa.clone();d.c=[];d.Ga=[];d.l=[];d.i=[];d.g=[];Za(e,d);d=d.b;d.Sa=c.clone();d.a=d.Sa.clone();c=this.b;c.a=c.g.clone();c.target=c.a.clone();c.M=c.a.clone();c.oa=!1;c.b=0;c.Ja=0;c=this.c;this.b.setPosition(c.b.a.x/160|0,c.b.a.y/
144|0);Qb(this.c,b.ja);Rb(this.c,this.b);c=this.progress;c.X=c.b;Ga(b.audio,b.u.C.testTrack)},new y(0,0,0)),Qb(this.c,a.ja)))))}hb(){}ab(a){a.moveTo(0,0);var b=this.b,c=g(this.g.i+16*b.M.x,96);a.clear(85,170,255);A(a,a.J.background,16,32,48,48,96,16,0);b=16*b.M.y|0;a.move(0,-b);for(var d=0;3>d;++d)A(a,a.J.background,0,0,96,32,Math.round(-c+96*d),96,0);z(a,255,255,255);a.fillRect(0,128,a.width,16);for(c=0;c<a.width/16|0;++c)A(a,a.J.background,0,32,16,32,16*c,144,0);z(a,0,85,170);a.fillRect(0,176,a.width,
Math.max(0,a.height+b-176));a.move(0,b);c=this.b;a.moveTo(-Math.round(c.M.x*c.width),-Math.round(c.M.y*c.height));this.i||0>=a.Ma||a.move(Math.round(Math.random()*a.La.x*2)-(a.La.x|0),Math.round(Math.random()*a.La.y*2)-(a.La.y|0));this.g.A(a,this.b);this.c.A(a);a.moveTo();b=a.J.font;for(d=0;d<this.progress.b;++d)c=9*(d/2|0),0==d%2&&A(a,b,40,0,8,8,c+3,2),this.progress.X>d&&A(a,b,32+d%2*4,0,4,8,c+3+d%2*4,2);b=String.fromCharCode(6)+String.fromCharCode(2)+String(this.progress.c);c=8*b.length+2;C(a,a.J.font,
b,a.width-c,2,0,0,!1);this.i&&(z(a,0,0,0,.67),a.fillRect(0,0,a.width,a.height),C(a,a.J.font,"PAUSED",a.width/2,a.height/2-4,0,0,!0));this.message.active&&(a.moveTo(0,0),this.message.A(a,!0))}};class Yb extends ta{constructor(a,b){super(a,b);this.b=new Oa(12,!0,[new Na("YES",c=>{c.audio.toggle(!0);c.audio.ib=n(.6,0,1);c.Ra(Xb)}),new Na("NO",c=>{c.audio.toggle(!1);c.Ra(Xb)})])}refresh(a){this.b.update(a)}ab(a){a.clear(0,85,170);C(a,a.J.font,"ENABLE AUDIO?\nPRESS ENTER\nTO CONFIRM.",32,a.height/2-32,0,2,!1);this.b.A(a,a.width/2,a.height/2+16)}};window.onload=()=>{var a=new Ma(160,144,0);a.u.load("assets/assets.json");var b=[{name:"fire1",key:"KeyZ",ta:0},{name:"fire2",key:"KeyX",ta:2},{name:"fire3",key:"KeyC",ta:1},{name:"start",key:"Enter",ta:9,Qa:7},{name:"back",key:"Escape"}];for(let c of b)I(a.b.input,c.name,c.key,c.ta,c.Qa);a.l=Yb;a.o=!1;a.loop(0)};
</script>
</body>
</html>
